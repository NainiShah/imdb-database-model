-- RATINGS GIVEN BY USER VIEW
CREATE VIEW USER_REVIEW_VIEW AS
SELECT USERNAME, RATING, REVIEW.DESCRIPTION, CASE
WHEN REVIEW.EPISODE_ID IS NOT NULL THEN ISNULL(TV_SHOW_NAME,'-') 
WHEN REVIEW.MOVIE_ID IS NOT NULL THEN ISNULL(MOVIE.NAME,'-') 
END AS REVIEW_ON, CASE
WHEN REVIEW.EPISODE_ID IS NOT NULL THEN 'TV SHOW' 
WHEN REVIEW.MOVIE_ID IS NOT NULL THEN 'MOVIE' 
END AS REVIEW_TYPE
FROM REVIEW JOIN USERACCOUNT ON REVIEW.USERID = USERACCOUNT.USERID
LEFT JOIN MOVIE ON REVIEW.MOVIE_ID = MOVIE.MOVIE_ID
LEFT JOIN EPISODES ON REVIEW.EPISODE_ID = EPISODES.EPISODE_ID
LEFT JOIN SEASON ON SEASON.SEASON_ID = EPISODES.SEASON_ID
LEFT JOIN TV_SHOW ON TV_SHOW.TV_SHOW_ID = SEASON.TV_SHOW_ID